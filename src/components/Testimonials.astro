---
import arquiBrokersRounded from "../assets/arqui-brokers-rounded-testimonials.webp";
import castellsInmueblesRound from "../assets/castells-rounded.webp";
import globalCargoRound from "../assets/global-cargo-rounded2.webp";
import acqualifeRound from "../assets/acqua-life-rounded.webp";
---

<section class="py-20 md:py-24 bg-[#EDF1F4] relative overflow-hidden" id="testimonials">
    <!-- Elementos decorativos sutiles en el fondo (ocultos en mobile para limpiar) -->
    <div class="hidden md:block absolute inset-0 z-0 pointer-events-none">
        <!-- Círculos pequeños -->
        <div
            class="absolute top-32 left-16 w-4 h-4 rounded-full"
            style="background-color: #759EBC; opacity: 0.6;"
        >
        </div>
        <div
            class="absolute top-48 right-24 w-3 h-3 rounded-full"
            style="background-color: #759EBC; opacity: 0.6;"
        >
        </div>
        <div
            class="absolute bottom-40 left-32 w-5 h-5 rounded-full"
            style="background-color: #759EBC; opacity: 0.6;"
        >
        </div>
        <div
            class="absolute bottom-56 right-16 w-4 h-4 rounded-full"
            style="background-color: #759EBC; opacity: 0.6;"
        >
        </div>
        <div
            class="absolute top-1/2 left-1/4 w-3 h-3 rounded-full"
            style="background-color: #759EBC; opacity: 0.6;"
        >
        </div>
        <div
            class="absolute top-1/3 right-1/3 w-4 h-4 rounded-full"
            style="background-color: #759EBC; opacity: 0.6;"
        >
        </div>
        <div
            class="absolute top-20 left-1/3 w-3 h-3 rounded-full"
            style="background-color: #759EBC; opacity: 0.6;"
        >
        </div>
        <div
            class="absolute top-64 right-16 w-4 h-4 rounded-full"
            style="background-color: #759EBC; opacity: 0.6;"
        >
        </div>
        <div
            class="absolute bottom-20 left-1/4 w-3 h-3 rounded-full"
            style="background-color: #759EBC; opacity: 0.6;"
        >
        </div>
        <div
            class="absolute bottom-32 right-1/3 w-4 h-4 rounded-full"
            style="background-color: #759EBC; opacity: 0.6;"
        >
        </div>
        <div
            class="absolute top-1/4 left-20 w-3 h-3 rounded-full"
            style="background-color: #759EBC; opacity: 0.6;"
        >
        </div>
        <div
            class="absolute top-3/4 right-1/4 w-4 h-4 rounded-full"
            style="background-color: #759EBC; opacity: 0.6;"
        >
        </div>
        <div
            class="absolute bottom-1/3 left-1/2 w-3 h-3 rounded-full"
            style="background-color: #759EBC; opacity: 0.6;"
        >
        </div>
        <div
            class="absolute top-1/5 right-1/5 w-4 h-4 rounded-full"
            style="background-color: #759EBC; opacity: 0.6;"
        >
        </div>

        <!-- Símbolos X -->
        <svg
            class="absolute top-40 right-12 w-6 h-6"
            fill="none"
            stroke="#759EBC"
            viewBox="0 0 24 24"
            style="opacity: 0.8;"
        >
            <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2.5"
                d="M6 18L18 6M6 6l12 12"></path>
        </svg>
        <svg
            class="absolute bottom-40 left-12 w-5 h-5"
            fill="none"
            stroke="#759EBC"
            viewBox="0 0 24 24"
            style="opacity: 0.8;"
        >
            <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2.5"
                d="M6 18L18 6M6 6l12 12"></path>
        </svg>
        <svg
            class="absolute top-60 right-40 w-5 h-5"
            fill="none"
            stroke="#759EBC"
            viewBox="0 0 24 24"
            style="opacity: 0.5;"
        >
            <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"></path>
        </svg>
        <svg
            class="absolute bottom-20 left-1/3 w-5 h-5"
            fill="none"
            stroke="#759EBC"
            viewBox="0 0 24 24"
            style="opacity: 0.5;"
        >
            <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"></path>
        </svg>
        <svg
            class="absolute bottom-32 right-16 w-5 h-5"
            fill="none"
            stroke="#759EBC"
            viewBox="0 0 24 24"
            style="opacity: 0.5;"
        >
            <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"></path>
        </svg>

        <!-- Símbolos + -->
        <div
            class="absolute top-24 left-24 text-4xl font-light"
            style="color: #759EBC; opacity: 0.8;"
        >
            +
        </div>
        <div
            class="absolute bottom-32 right-28 text-4xl font-light"
            style="color: #759EBC; opacity: 0.8;"
        >
            +
        </div>
        <div
            class="absolute top-1/2 right-20 text-3xl font-light"
            style="color: #759EBC; opacity: 0.8;"
        >
            +
        </div>
        <div
            class="absolute top-16 right-1/4 text-3xl font-light"
            style="color: #759EBC; opacity: 0.5;"
        >
            +
        </div>
        <div
            class="absolute bottom-24 left-1/4 text-3xl font-light"
            style="color: #759EBC; opacity: 0.5;"
        >
            +
        </div>
    </div>

    <div class="container mx-auto px-6 md:px-8 relative z-10">
        <div class="text-center max-w-3xl mx-auto mb-10 md:mb-16">
            <h2
                class="text-3xl md:text-5xl font-extrabold text-[#0F172A] mb-3 md:mb-4 tracking-tight"
            >
                Testimonios
            </h2>
            <p class="text-slate-500 text-lg md:text-xl leading-relaxed">
                Lo que dicen nuestros clientes
            </p>
        </div>
        <div class="text-center">
            <a
                href="#"
                class="inline-flex items-center gap-2 bg-primary-dark text-white px-8 py-4 rounded-full font-semibold mt-0 mb-5 hover:bg-primary-light transition-colors shadow-md"
            >
                Trabajemos juntos
                <span>→</span>
            </a>
        </div>

        <!-- Carousel Container -->
        <div
            class="relative overflow-hidden w-full mt-8 md:mt-12"
            id="testimonials-container"
        >   
            <!-- Controles de flechas -->
            <button
                id="prev-btn"
                class="absolute left-4 top-1/2 -translate-y-1/2 z-20 w-12 h-12 md:w-14 md:h-14 bg-white/90 hover:bg-white rounded-full shadow-lg flex items-center justify-center transition-all duration-200 hover:scale-110 disabled:opacity-50 disabled:cursor-not-allowed"
                aria-label="Testimonio anterior"
            >
                <svg
                    class="w-6 h-6 text-[#0F172A]"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                >
                    <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M15 19l-7-7 7-7"
                    ></path>
                </svg>
            </button>

            <button
                id="next-btn"
                class="absolute right-4 top-1/2 -translate-y-1/2 z-20 w-12 h-12 md:w-14 md:h-14 bg-white/90 hover:bg-white rounded-full shadow-lg flex items-center justify-center transition-all duration-200 hover:scale-110 disabled:opacity-50 disabled:cursor-not-allowed"
                aria-label="Testimonio siguiente"
            >
                <svg
                    class="w-6 h-6 text-[#0F172A]"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                >
                    <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M9 5l7 7-7 7"
                    ></path>
                </svg>
            </button>

            <div
                class="flex w-max transition-transform duration-500 ease-in-out"
                id="testimonials-track"
            >
                <!-- Testimonio 1 -->
                <div class="flex-shrink-0 select-none testimonial-slide" data-slide-width>
                    <div class="px-4 md:px-8 flex justify-center">
                        <div
                            class="bg-transparent rounded-[2.5rem] p-8 md:p-12 w-full max-w-4xl h-full flex flex-col md:flex-row items-center gap-6 md:gap-12"
                        >
                        <!-- Logo con forma asimétrica -->
                        <div class="shrink-0 relative w-40 h-40 md:w-56 md:h-56 mb-6 md:mb-0">
                            <svg class="w-full h-full" viewBox="0 0 160 160" xmlns="http://www.w3.org/2000/svg">
                                <defs>
                                    <clipPath id="asymmetric-shape-1">
                                        <circle cx="80" cy="80" r="75" />
                                    </clipPath>
                                </defs>
                                <image
                                    href={arquiBrokersRounded.src}
                                    x="0"
                                    y="0"
                                    width="160"
                                    height="160"
                                    clip-path="url(#asymmetric-shape-1)"
                                    preserveAspectRatio="xMidYMid meet"
                                />
                            </svg>
                        </div>
                        <!-- Contenido del testimonio -->
                        <div class="flex-1 text-center md:text-left">
                            <div class="mb-4">
                                <h3
                                    class="text-xl md:text-2xl font-bold text-[#0F172A] mb-1"
                                >
                                    Aqr. Allison Barbosa
                                </h3>
                                <p
                                    class="text-[#759EBC] font-semibold text-sm md:text-base tracking-wide"
                                >
                                    Socio Arquibrokers
                                </p>
                            </div>
                            <p
                                class="text-[#4A5568] text-base md:text-lg leading-relaxed font-normal"
                            >
                                Henko nos demostró por qué está considerada
                                entre <b
                                    >las mejores agencias de marketing
                                    digital en Uruguay</b
                                >: resultados claros y acompañamiento
                                constante.
                            </p>
                        </div>
                    </div>
                    </div>
                </div>

                <!-- Testimonio 2 -->
                <div class="flex-shrink-0 select-none testimonial-slide" data-slide-width>
                    <div class="px-4 md:px-8 flex justify-center">
                        <div
                            class="bg-transparent rounded-[2.5rem] p-8 md:p-12 w-full max-w-4xl h-full flex flex-col md:flex-row items-center gap-6 md:gap-12"
                        >
                        <!-- Logo con forma asimétrica -->
                        <div class="shrink-0 relative w-40 h-40 md:w-56 md:h-56 mb-6 md:mb-0">
                            <svg class="w-full h-full" viewBox="0 0 160 160" xmlns="http://www.w3.org/2000/svg">
                                <defs>
                                    <clipPath id="asymmetric-shape-1">
                                        <circle cx="80" cy="80" r="75" />
                                    </clipPath>
                                </defs>
                                <image
                                    href={castellsInmueblesRound.src}
                                    x="0"
                                    y="0"
                                    width="160"
                                    height="160"
                                    clip-path="url(#asymmetric-shape-1)"
                                    preserveAspectRatio="xMidYMid meet"
                                />
                            </svg>
                        </div>
                        <!-- Contenido del testimonio -->
                        <div class="flex-1 text-center md:text-left">
                            <div class="mb-4">
                                <h3
                                    class="text-xl md:text-2xl font-bold text-[#0F172A] mb-1"
                                >
                                    Andrés Zugarramurdi
                                </h3>
                                <p
                                    class="text-[#759EBC] font-semibold text-sm md:text-base tracking-wide"
                                >
                                    Encargado de Marketing (Castells)
                                </p>
                            </div>
                            <p
                                class="text-[#4A5568] text-base md:text-lg leading-relaxed font-normal"
                            >
                            Henko se convirtió en un socio estratégico para nuestro crecimiento digital. Más que una agencia de marketing digital, es un equipo que acompaña de forma cercana, trabaja con datos y optimiza campañas de manera constante para lograr resultados medibles y sostenidos en el tiempo.
                            </p>
                        </div>
                    </div>
                    </div>
                </div>

                <!-- Testimonio 3 -->
                <div class="flex-shrink-0 select-none testimonial-slide" data-slide-width>
                    <div class="px-4 md:px-8 flex justify-center">
                        <div
                            class="bg-transparent rounded-[2.5rem] p-8 md:p-12 w-full max-w-4xl h-full flex flex-col md:flex-row items-center gap-6 md:gap-12"
                        >
                        <!-- Logo con forma asimétrica -->
                        <div class="shrink-0 relative w-40 h-40 md:w-56 md:h-56 mb-6 md:mb-0">
                            <svg class="w-full h-full" viewBox="0 0 160 160" xmlns="http://www.w3.org/2000/svg">
                                <defs>
                                    <clipPath id="asymmetric-shape-1">
                                        <circle cx="80" cy="80" r="75" />
                                    </clipPath>
                                </defs>
                                <image
                                    href={acqualifeRound.src}
                                    x="0"
                                    y="0"
                                    width="160"
                                    height="160"
                                    clip-path="url(#asymmetric-shape-1)"
                                    preserveAspectRatio="xMidYMid meet"
                                />
                            </svg>
                        </div>
                        <!-- Contenido del testimonio -->
                        <div class="flex-1 text-center md:text-left">
                            <div class="mb-4">
                                <h3
                                    class="text-xl md:text-2xl font-bold text-[#0F172A] mb-1"
                                >
                                    Marcelo B.
                                </h3>
                                <p
                                    class="text-[#759EBC] font-semibold text-sm md:text-base tracking-wide"
                                >
                                    Director (Acqualife)
                                </p>
                            </div>
                            <p
                                class="text-[#4A5568] text-base md:text-lg leading-relaxed font-normal"
                            >
                                Valoramos el trabajo que venimos desarrollando junto a Henko a lo largo de los años para fortalecer la presencia digital de nuestra marca a través de campañas en Google Ads, Meta Ads y otros medios digitales. Es una agencia de marketing digital con foco en performance, que trabaja con objetivos claros y logra superar año a año las metas de crecimiento y resultados.
                            </p>
                        </div>
                    </div>
                    </div>
                </div>

                <!-- Testimonio 4 -->
                <div class="flex-shrink-0 select-none testimonial-slide" data-slide-width>
                    <div class="px-4 md:px-8 flex justify-center">
                        <div
                            class="bg-transparent rounded-[2.5rem] p-8 md:p-12 w-full max-w-4xl h-full flex flex-col md:flex-row items-center gap-6 md:gap-12"
                        >
                        <!-- Logo con forma asimétrica -->
                        <div class="shrink-0 relative w-40 h-40 md:w-56 md:h-56 mb-6 md:mb-0">
                            <svg class="w-full h-full" viewBox="0 0 160 160" xmlns="http://www.w3.org/2000/svg">
                                <defs>
                                    <clipPath id="asymmetric-shape-1">
                                        <circle cx="80" cy="80" r="75" />
                                    </clipPath>
                                </defs>
                                <image
                                    href={globalCargoRound.src}
                                    x="0"
                                    y="0"
                                    width="160"
                                    height="160"
                                    clip-path="url(#asymmetric-shape-1)"
                                    preserveAspectRatio="xMidYMid meet"
                                />
                            </svg>
                        </div>
                        <!-- Contenido del testimonio -->
                        <div class="flex-1 text-center md:text-left">
                            <div class="mb-4">
                                <h3
                                    class="text-xl md:text-2xl font-bold text-[#0F172A] mb-1"
                                >
                                    Sergio A.
                                </h3>
                                <p
                                    class="text-[#759EBC] font-semibold text-sm md:text-base tracking-wide"
                                >
                                    CEO (Global Cargo)
                                </p>
                            </div>
                            <p
                                class="text-[#4A5568] text-base md:text-lg leading-relaxed font-normal"
                            >
                            Es un gusto trabajar con el equipo de Henko. Son un partner estratégico en marketing digital, siempre atentos a los detalles y con una forma de trabajo clara y eficiente. Logran muy buenos resultados en campañas digitales, combinando profesionalismo, análisis de datos y una calidez humana que marca la diferencia
                            </p>
                        </div>
                    </div>
                    </div>
                </div>

            </div>
        </div>

        <!-- Progress Bar con indicador circular -->
        <div class="mt-12 flex flex-col items-center gap-2">
            <div
                class="relative w-full max-w-xs h-1 bg-[#D1D5DB] rounded-full overflow-visible"
            >
                <div
                    id="progress-bar"
                    class="h-full bg-[#4A5568] rounded-full transition-all duration-500 ease-out"
                    style="width: 33.33%;"
                >
                </div>
                <div
                    id="progress-indicator"
                    class="absolute top-1/2 -translate-y-1/2 w-3 h-3 bg-[#759EBC] rounded-full transition-all duration-500 ease-out shadow-md"
                    style="left: calc(33.33% - 6px);"
                >
                </div>
            </div>
        </div>
    </div>
</section>

<script>
    import { gsap } from "gsap";

    document.addEventListener("DOMContentLoaded", () => {
        const track = document.getElementById("testimonials-track");
        const container = document.getElementById("testimonials-container");
        const prevBtn = document.getElementById("prev-btn");
        const nextBtn = document.getElementById("next-btn");
        const progressBar = document.getElementById("progress-bar");
        const progressIndicator = document.getElementById("progress-indicator");

        if (!track || !container || !prevBtn || !nextBtn) return;

        const slides = track.querySelectorAll(".testimonial-slide");
        const totalSlides = slides.length;
        let currentIndex = 0;

        // Establecer el ancho de cada slide igual al contenedor
        const setSlideWidths = () => {
            const containerWidth = container.offsetWidth;
            slides.forEach((slide) => {
                (slide as HTMLElement).style.width = `${containerWidth}px`;
            });
        };

        const updateCarousel = () => {
            setSlideWidths();
            const containerWidth = container.offsetWidth;
            const translateX = -(currentIndex * containerWidth);

            gsap.to(track, {
                x: translateX,
                duration: 0.5,
                ease: "power2.out",
            });

            // Actualizar progress bar
            const progress = ((currentIndex + 1) / totalSlides) * 100;
            if (progressBar) {
                progressBar.style.width = `${progress}%`;
            }
            if (progressIndicator) {
                progressIndicator.style.left = `calc(${progress}% - 6px)`;
            }

            // Actualizar estado de los botones
            if (prevBtn) {
                (prevBtn as HTMLButtonElement).disabled = currentIndex === 0;
            }
            if (nextBtn) {
                (nextBtn as HTMLButtonElement).disabled = currentIndex === totalSlides - 1;
            }
        };

        if (prevBtn) {
            prevBtn.addEventListener("click", () => {
                if (currentIndex > 0) {
                    currentIndex--;
                    updateCarousel();
                }
            });
        }

        if (nextBtn) {
            nextBtn.addEventListener("click", () => {
                if (currentIndex < totalSlides - 1) {
                    currentIndex++;
                    updateCarousel();
                }
            });
        }

        // Inicializar
        setSlideWidths();
        updateCarousel();

        // Manejar redimensionamiento
        let resizeTimeout: NodeJS.Timeout;
        window.addEventListener("resize", () => {
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(() => {
                setSlideWidths();
                updateCarousel();
            }, 250);
        });
    });
</script>

<style>
    #testimonials-track {
        will-change: transform;
    }
</style>
