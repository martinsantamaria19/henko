---
import innovacionIcon from "../assets/innovacion-icon.webp";
import impactoIcon from "../assets/impacto-icon.webp";
import trascendenciaIcon from "../assets/trascendencia-icon.webp";
import evolucionIcon from "../assets/evolucion-icon.webp";
import propositoIcon from "../assets/proposito-icon.webp";
import pertinenciaIcon from "../assets/pertinencia-icon.webp";

const values = [
    {
        id: "innovacion",
        icon: innovacionIcon,
        title: "Innovación",
        description: "Estrategias digitales actualizadas que se adaptan a tu rubro.",
        color: "bg-blue-50",
        accent: "text-blue-500"
    },
    {
        id: "impacto",
        icon: impactoIcon,
        title: "Impacto",
        description: "Campañas de publicidad online que generan clientes y ventas.",
        color: "bg-indigo-50",
        accent: "text-indigo-500"
    },
    {
        id: "trascendencia",
        icon: trascendenciaIcon,
        title: "Trascendencia",
        description: "Posicionamos tu marca entre las mejores de Uruguay.",
        color: "bg-purple-50",
        accent: "text-purple-500"
    }
];
---

<section class="relative py-24 md:py-32 bg-slate-50 overflow-hidden" id="nuestros-valores">
    <div class="container mx-auto px-4 md:px-8">
        <div class="mb-24 text-center max-w-3xl mx-auto">
            <h2 class="js-fade-up text-4xl md:text-6xl font-black text-slate-900 mb-6 tracking-tight opacity-0">
                ¿Por qué elegirnos?
            </h2>
            <p class="js-fade-up text-lg md:text-xl text-slate-600 leading-relaxed opacity-0">
                Somos la agencia de marketing digital que tu empresa necesita
            </p>
        </div>

        <div class="relative pb-24">
            {values.map((value, index) => (
                <div 
                    class="sticky-card sticky w-full max-w-5xl mx-auto mb-24 md:mb-32 last:mb-0 perspective-1000"
                    style={`top: ${120 + index * 15}px; z-index: ${index + 1};`}
                >
                    <div class={`card-inner relative overflow-hidden rounded-[2.5rem] p-8 md:p-16 shadow-2xl transition-all duration-500 border border-white/60 backdrop-blur-xl ${value.color}`}>
                        
                        <!-- Decorative Background Gradient -->
                        <div class="absolute top-0 right-0 -mt-20 -mr-20 w-80 h-80 bg-white/60 rounded-full blur-3xl pointer-events-none mix-blend-overlay"></div>
                        <div class="absolute bottom-0 left-0 -mb-20 -ml-20 w-80 h-80 bg-white/60 rounded-full blur-3xl pointer-events-none mix-blend-overlay"></div>

                        <div class="relative z-10 flex flex-col md:flex-row items-center md:items-start gap-8 md:gap-16">
                            <!-- Icon Container -->
                            <div class="flex-shrink-0 w-24 h-24 md:w-32 md:h-32 rounded-3xl bg-white shadow-xl flex items-center justify-center transform transition-transform hover:scale-110 duration-500 group">
                                <img 
                                    src={value.icon.src} 
                                    alt={value.title} 
                                    class="w-12 h-12 md:w-16 md:h-16 object-contain transition-transform duration-500 group-hover:rotate-12"
                                />
                            </div>

                            <!-- Content -->
                            <div class="flex-1 text-center md:text-left pt-2">
                                <div class="flex items-center justify-center md:justify-start gap-6 mb-6 relative">
                                    <span class={`text-8xl md:text-9xl font-black opacity-5 absolute -top-8 -left-8 md:-left-12 select-none ${value.accent}`}>
                                        {String(index + 1).padStart(2, '0')}
                                    </span>
                                    <h3 class="text-3xl md:text-5xl font-black text-slate-900 relative z-10">
                                        {value.title}
                                    </h3>
                                </div>
                                <p class="text-lg md:text-2xl text-slate-700 leading-relaxed font-medium max-w-2xl">
                                    {value.description}
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            ))}
        </div>
    </div>
</section>

<script>
    import { gsap } from "gsap";
    import { ScrollTrigger } from "gsap/ScrollTrigger";

    gsap.registerPlugin(ScrollTrigger);

    document.addEventListener("DOMContentLoaded", () => {
        // Header Animation
        const headerElements = document.querySelectorAll('.js-fade-up');
        gsap.fromTo(headerElements, 
            { y: 30, opacity: 0 },
            { 
                y: 0, 
                opacity: 1, 
                duration: 1, 
                stagger: 0.2, 
                ease: "power3.out",
                scrollTrigger: {
                    trigger: "#nuestros-valores",
                    start: "top 80%"
                }
            }
        );

        // Cards Stacking Animation
        const cards = document.querySelectorAll('.sticky-card');
        
        cards.forEach((card, index) => {
            // Initial entrance animation
            gsap.fromTo(card,
                { y: 100, opacity: 0, scale: 0.9 },
                {
                    y: 0,
                    opacity: 1,
                    scale: 1,
                    duration: 0.8,
                    ease: "power3.out",
                    scrollTrigger: {
                        trigger: card,
                        start: "top 90%",
                    }
                }
            );

            // Stacking effect (scale down when next card comes)
            if (index < cards.length - 1) {
                const nextCard = cards[index + 1];
                const innerCard = card.querySelector('.card-inner');

                gsap.to(innerCard, {
                    scale: 0.85, // More pronounced scaling
                    opacity: 0.5, // Keep it slightly more visible
                    filter: "blur(8px)", // Stronger blur
                    transformOrigin: "center top",
                    ease: "none",
                    scrollTrigger: {
                        trigger: nextCard,
                        start: "top 75%", // Start earlier (when next card is lower)
                        end: "top 25%", // End later (when next card is higher)
                        scrub: true
                    }
                });
            }
        });
    });
</script>

<style>
    .perspective-1000 {
        perspective: 1000px;
    }
    .card-inner {
        will-change: transform, opacity, filter;
    }
</style>
