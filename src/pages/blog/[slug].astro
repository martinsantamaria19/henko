---
import Layout from "../../layouts/Layout.astro";
import { getPostBySlug, getAllSlugs } from "../../data/blog";
import type { GetStaticPaths } from "astro";

export const getStaticPaths: GetStaticPaths = () => {
  const slugs = getAllSlugs();
  return slugs.map((slug) => ({ params: { slug } }));
};

const { slug } = Astro.params;
const post = slug ? getPostBySlug(String(slug)) : undefined;

if (!post) {
  return Astro.redirect("/blog");
}

const { title, excerpt, image, imageAlt, category, date, content } = post;
---

<Layout
  title={`${title} | Henko Blog`}
  description={excerpt}
  image={image}
>
  <article class="py-16 my-20 md:my-0 md:py-24">
    <div class="container mx-auto px-6 md:px-8 max-w-4xl">
      <!-- Breadcrumb -->
      <nav class="mb-8 md:mb-12" aria-label="Breadcrumb">
        <ol class="flex items-center gap-2 text-sm text-gray-500">
          <li>
            <a href="/" class="hover:text-primary-dark transition-colors">Home</a>
          </li>
          <li aria-hidden="true">/</li>
          <li>
            <a href="/blog" class="hover:text-primary-dark transition-colors">Blog</a>
          </li>
          <li aria-hidden="true">/</li>
          <li class="text-gray-700 font-medium truncate max-w-[200px] md:max-w-none" aria-current="page">
            {title}
          </li>
        </ol>
      </nav>

      <!-- Meta -->
      <div class="flex flex-wrap justify-between items-center gap-4 text-xs text-gray-400 font-medium uppercase tracking-wide mb-6">
        <span>{category}</span>
        <time datetime={date}>{date}</time>
      </div>

      <!-- TÃ­tulo -->
      <h1 class="text-3xl md:text-4xl lg:text-5xl font-bold text-[#1A1A1A] leading-tight mb-8">
        {title}
      </h1>

      <!-- Imagen destacada -->
      <div class="rounded-[32px] overflow-hidden shadow-lg mb-12 bg-gray-100">
        <img
          src={image}
          alt={imageAlt}
          class="w-full h-auto object-cover aspect-[16/10]"
          width="800"
          height="500"
          loading="eager"
          fetchpriority="high"
        />
      </div>

      <!-- Contenido -->
      <div
        class="article-content text-gray-600 leading-relaxed"
        set:html={content}
      />

      <!-- Volver al blog -->
      <div class="mt-16 pt-10 border-t border-gray-200">
        <a
          href="/blog"
          class="inline-flex items-center gap-2 text-primary-dark font-semibold hover:underline"
        >
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
          </svg>
          Volver al blog
        </a>
      </div>
    </div>
  </article>
</Layout>

<style>
  .article-content :global(h3) {
    font-weight: 700;
    color: #1a1a1a;
    margin-top: 2.5rem;
    margin-bottom: 1rem;
    font-size: 1.25rem;
  }
  .article-content :global(p) {
    margin-bottom: 1.5rem;
    line-height: 1.75;
  }
  .article-content :global(p:first-child) {
    margin-top: 0;
  }
  .article-content :global(a) {
    color: var(--color-primary-dark);
    text-decoration: none;
  }
  .article-content :global(a:hover) {
    text-decoration: underline;
  }
</style>
