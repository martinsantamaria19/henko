---
// Importar todas las imágenes - Solo necesitas subir estos archivos a src/assets/
import meetingImage from "../assets/meeting.webp";
import planningImage from "../assets/planning.webp";
import estrategiaImage from "../assets/estrategia.webp";
import campanasImage from "../assets/campanas.webp";
import desarrolloImage from "../assets/desarrollo.webp";
import entregaImage from "../assets/entrega.webp";
---

<div
    class="relative bg-primary-dark text-white overflow-hidden flex flex-col min-h-[80vh] group"
    style="background-color: #0B1B32;"
>
    <button
        id="prevArrow"
        class="absolute left-4 md:left-8 top-1/2 -translate-y-1/2 z-30 w-10 h-10 md:w-12 md:h-12 bg-white/10 hover:bg-white/20 rounded-full flex items-center justify-center transition-all duration-300 backdrop-blur-sm border border-white/20 hover:scale-110 active:scale-95 cursor-pointer opacity-50 md:opacity-0 group-hover:opacity-100"
        aria-label="Slide anterior"
    >
        <svg
            class="w-5 h-5 text-white"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
        >
            <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M15 19l-7-7 7-7"></path>
        </svg>
    </button>

    <button
        id="nextArrow"
        class="absolute right-4 md:right-8 top-1/2 -translate-y-1/2 z-30 w-10 h-10 md:w-12 md:h-12 bg-white/10 hover:bg-white/20 rounded-full flex items-center justify-center transition-all duration-300 backdrop-blur-sm border border-white/20 hover:scale-110 active:scale-95 cursor-pointer opacity-50 md:opacity-0 group-hover:opacity-100"
        aria-label="Slide siguiente"
    >
        <svg
            class="w-5 h-5 text-white"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
        >
            <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M9 5l7 7-7 7"></path>
        </svg>
    </button>

    <!-- Forma decorativa azul de fondo -->
    <div class="absolute right-0 top-0 w-[800px] h-[600px] -z-0 opacity-20">
        <svg
            viewBox="0 0 800 600"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
            class="w-full h-full"
        >
            <path
                d="M800 0C800 0 650 100 550 200C450 300 400 400 300 450C200 500 100 550 0 600V0H800Z"
                fill="url(#blueGradient)"
                opacity="0.3"></path>
            <defs>
                <linearGradient
                    id="blueGradient"
                    x1="0%"
                    y1="0%"
                    x2="100%"
                    y2="100%"
                >
                    <stop
                        offset="0%"
                        style="stop-color:#3B82F6;stop-opacity:0.4"></stop>
                    <stop
                        offset="100%"
                        style="stop-color:#1E40AF;stop-opacity:0.2"></stop>
                </linearGradient>
            </defs>
        </svg>
    </div>

    <div
        class="container mx-auto px-8 md:px-16 relative z-10 h-full flex flex-col py-16 md:py-20"
        style="min-height: 80vh;"
    >
        <div
            class="grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-16 flex-grow items-center"
        >
            <!-- Columna Izquierda -->
            <div class="flex flex-col justify-between h-full">
                <!-- Sección superior: Título y descripción -->
                <div class="flex-shrink-0">
                    <h2
                        class="text-4xl md:text-5xl lg:text-6xl font-bold leading-tight mb-6"
                    >
                        ¿Cómo lo hacemos?
                    </h2>
                    <p
                        class="text-gray-400 text-base md:text-lg leading-relaxed max-w-lg"
                    >
                        Lorem ipsum dolor sit amet, consectetuer adipiscing
                        elit, sed diam nonummy nibh euismod tincidunt ut laoreet
                        dolore magna aliquam erat volutpat.
                    </p>
                </div>

                <!-- Espaciador flexible -->
                <div class="flex-grow"></div>

                <!-- Sección inferior: Contenido del slide + indicadores -->
                <div class="flex-shrink-0 flex flex-col gap-16">
                    <!-- Contenedor de slides con altura mínima -->
                    <div class="relative min-h-[180px]">
                        <div
                            class="slide-text absolute inset-0 transition-opacity duration-500 ease-in-out opacity-0"
                            data-slide="0"
                        >
                            <h3
                                class="text-3xl md:text-4xl lg:text-5xl font-bold mb-4"
                                style="font-style: italic;"
                            >
                                Meeting
                            </h3>
                            <p
                                class="text-gray-300 text-base md:text-lg leading-relaxed max-w-md"
                            >
                                Lorem ipsum dolor sit amet, consectetuer
                                adipiscing elit, sed diam nonummy nibh euismod
                                tincidunt ut laoreet dolore magna aliquam erat
                                volutpat.
                            </p>
                        </div>

                        <div
                            class="slide-text absolute inset-0 transition-opacity duration-500 ease-in-out opacity-0"
                            data-slide="1"
                        >
                            <h3
                                class="text-3xl md:text-4xl lg:text-5xl font-bold mb-4"
                                style="font-style: italic;"
                            >
                                Planning
                            </h3>
                            <p
                                class="text-gray-300 text-base md:text-lg leading-relaxed max-w-md"
                            >
                                Lorem ipsum dolor sit amet, consectetuer
                                adipiscing elit, sed diam nonummy nibh euismod
                                tincidunt ut laoreet dolore magna aliquam erat
                                volutpat.
                            </p>
                        </div>

                        <div
                            class="slide-text absolute inset-0 transition-opacity duration-500 ease-in-out opacity-0"
                            data-slide="2"
                        >
                            <h3
                                class="text-3xl md:text-4xl lg:text-5xl font-bold mb-4"
                                style="font-style: italic;"
                            >
                                Estrategia
                            </h3>
                            <p
                                class="text-gray-300 text-base md:text-lg leading-relaxed max-w-md"
                            >
                                Lorem ipsum dolor sit amet, consectetuer
                                adipiscing elit, sed diam nonummy nibh euismod
                                tincidunt ut laoreet dolore magna aliquam erat
                                volutpat.
                            </p>
                        </div>

                        <div
                            class="slide-text absolute inset-0 transition-opacity duration-500 ease-in-out opacity-0"
                            data-slide="3"
                        >
                            <h3
                                class="text-3xl md:text-4xl lg:text-5xl font-bold mb-4"
                                style="font-style: italic;"
                            >
                                Campañas
                            </h3>
                            <p
                                class="text-gray-300 text-base md:text-lg leading-relaxed max-w-md"
                            >
                                Lorem ipsum dolor sit amet, consectetuer
                                adipiscing elit, sed diam nonummy nibh euismod
                                tincidunt ut laoreet dolore magna aliquam erat
                                volutpat.
                            </p>
                        </div>

                        <div
                            class="slide-text absolute inset-0 transition-opacity duration-500 ease-in-out opacity-0"
                            data-slide="4"
                        >
                            <h3
                                class="text-3xl md:text-4xl lg:text-5xl font-bold mb-4"
                                style="font-style: italic;"
                            >
                                Desarrollo
                            </h3>
                            <p
                                class="text-gray-300 text-base md:text-lg leading-relaxed max-w-md"
                            >
                                Lorem ipsum dolor sit amet, consectetuer
                                adipiscing elit, sed diam nonummy nibh euismod
                                tincidunt ut laoreet dolore magna aliquam erat
                                volutpat.
                            </p>
                        </div>

                        <div
                            class="slide-text absolute inset-0 transition-opacity duration-500 ease-in-out opacity-0"
                            data-slide="5"
                        >
                            <h3
                                class="text-3xl md:text-4xl lg:text-5xl font-bold mb-4"
                                style="font-style: italic;"
                            >
                                Entrega
                            </h3>
                            <p
                                class="text-gray-300 text-base md:text-lg leading-relaxed max-w-md"
                            >
                                Lorem ipsum dolor sit amet, consectetuer
                                adipiscing elit, sed diam nonummy nibh euismod
                                tincidunt ut laoreet dolore magna aliquam erat
                                volutpat.
                            </p>
                        </div>
                    </div>

                    <!-- Indicadores separados con gap -->
                    <div class="flex gap-2" id="sliderIndicators">
                        <button
                            class="indicator h-3 bg-gray-500 rounded-full transition-all duration-300 hover:bg-opacity-80 cursor-pointer"
                            data-index="0"
                            aria-label="Slide 1"
                            style="width: 32px;"></button>
                        <button
                            class="indicator h-3 bg-gray-500 rounded-full transition-all duration-300 hover:bg-opacity-80 cursor-pointer"
                            data-index="1"
                            aria-label="Slide 2"
                            style="width: 32px;"></button>
                        <button
                            class="indicator h-3 bg-gray-500 rounded-full transition-all duration-300 hover:bg-opacity-80 cursor-pointer"
                            data-index="2"
                            aria-label="Slide 3"
                            style="width: 32px;"></button>
                        <button
                            class="indicator h-3 bg-gray-500 rounded-full transition-all duration-300 hover:bg-opacity-80 cursor-pointer"
                            data-index="3"
                            aria-label="Slide 4"
                            style="width: 32px;"></button>
                        <button
                            class="indicator h-3 bg-gray-500 rounded-full transition-all duration-300 hover:bg-opacity-80 cursor-pointer"
                            data-index="4"
                            aria-label="Slide 5"
                            style="width: 32px;"></button>
                        <button
                            class="indicator h-3 bg-gray-500 rounded-full transition-all duration-300 hover:bg-opacity-80 cursor-pointer"
                            data-index="5"
                            aria-label="Slide 6"
                            style="width: 32px;"></button>
                    </div>
                </div>
            </div>

            <!-- Columna Derecha - Imagen centrada verticalmente -->
            <div
                class="relative flex items-center justify-center min-h-[400px] lg:h-full"
            >
                <div
                    class="absolute w-[450px] h-[450px] bg-white/5 rounded-full blur-3xl -z-10"
                >
                </div>

                <div
                    class="relative w-[350px] h-[350px] md:w-[400px] md:h-[400px] flex items-center justify-center"
                >
                    <div
                        id="illustration-0"
                        class="absolute inset-0 flex items-center justify-center opacity-0 transition-all duration-500"
                    >
                    </div>
                    <div
                        id="illustration-1"
                        class="absolute inset-0 flex items-center justify-center opacity-0 transition-all duration-500"
                    >
                    </div>
                    <div
                        id="illustration-2"
                        class="absolute inset-0 flex items-center justify-center opacity-0 transition-all duration-500"
                    >
                    </div>
                    <div
                        id="illustration-3"
                        class="absolute inset-0 flex items-center justify-center opacity-0 transition-all duration-500"
                    >
                    </div>
                    <div
                        id="illustration-4"
                        class="absolute inset-0 flex items-center justify-center opacity-0 transition-all duration-500"
                    >
                    </div>
                    <div
                        id="illustration-5"
                        class="absolute inset-0 flex items-center justify-center opacity-0 transition-all duration-500"
                    >
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script
    define:vars={{
        meetingImageUrl: meetingImage.src,
        planningImageUrl: planningImage.src,
        estrategiaImageUrl: estrategiaImage.src,
        campanasImageUrl: campanasImage.src,
        desarrolloImageUrl: desarrolloImage.src,
        entregaImageUrl: entregaImage.src,
    }}
>
    // Imágenes
    const slideImages = [
        `<img src="${meetingImageUrl}" alt="Meeting" class="max-w-[300px] max-h-[300px] w-auto h-auto object-contain drop-shadow-xl" />`,
        `<img src="${planningImageUrl}" alt="Planning" class="max-w-[300px] max-h-[300px] w-auto h-auto object-contain drop-shadow-xl" />`,
        `<img src="${estrategiaImageUrl}" alt="Estrategia" class="max-w-[300px] max-h-[300px] w-auto h-auto object-contain drop-shadow-xl" />`,
        `<img src="${campanasImageUrl}" alt="Campañas" class="max-w-[300px] max-h-[300px] w-auto h-auto object-contain drop-shadow-xl" />`,
        `<img src="${desarrolloImageUrl}" alt="Desarrollo" class="max-w-[300px] max-h-[300px] w-auto h-auto object-contain drop-shadow-xl" />`,
        `<img src="${entregaImageUrl}" alt="Entrega" class="max-w-[300px] max-h-[300px] w-auto h-auto object-contain drop-shadow-xl" />`,
    ];

    let currentSlide = 1;
    const totalSlides = 6;
    let autoSlideInterval = null;

    function initSlider() {
        const textSlides = document.querySelectorAll(".slide-text");
        const indicators = document.querySelectorAll(".indicator");

        // Precargar imágenes en el DOM
        for (let i = 0; i < slideImages.length; i++) {
            const container = document.getElementById(`illustration-${i}`);
            if (container) container.innerHTML = slideImages[i];
        }

        function showSlide(index) {
            // 1. Textos
            textSlides.forEach((slide, i) => {
                if (i === index) {
                    slide.classList.remove("opacity-0", "translate-y-4");
                    slide.classList.add("opacity-100", "translate-y-0", "z-10");
                } else {
                    slide.classList.remove(
                        "opacity-100",
                        "translate-y-0",
                        "z-10",
                    );
                    slide.classList.add("opacity-0", "translate-y-4");
                }
            });

            // 2. Imágenes
            for (let i = 0; i < totalSlides; i++) {
                const container = document.getElementById(`illustration-${i}`);
                if (container) {
                    if (i === index) {
                        container.style.opacity = "1";
                        container.style.transform = "scale(1)";
                    } else {
                        container.style.opacity = "0";
                        container.style.transform = "scale(0.9)";
                    }
                }
            }

            // 3. Indicadores
            indicators.forEach((indicator, i) => {
                if (i === index) {
                    indicator.classList.remove("bg-gray-500");
                    indicator.classList.add("bg-white");
                    indicator.style.width = "48px";
                } else {
                    indicator.classList.remove("bg-white");
                    indicator.classList.add("bg-gray-500");
                    indicator.style.width = "32px";
                }
            });

            currentSlide = index;
        }

        function nextSlide() {
            showSlide((currentSlide + 1) % totalSlides);
        }
        function prevSlide() {
            showSlide((currentSlide - 1 + totalSlides) % totalSlides);
        }

        function startAutoSlide() {
            if (autoSlideInterval) clearInterval(autoSlideInterval);
            autoSlideInterval = setInterval(nextSlide, 5000);
        }

        function stopAutoSlide() {
            if (autoSlideInterval) {
                clearInterval(autoSlideInterval);
                autoSlideInterval = null;
            }
        }

        // Event Listeners
        indicators.forEach((indicator, index) => {
            indicator.addEventListener("click", () => {
                showSlide(index);
                stopAutoSlide();
                startAutoSlide();
            });
        });

        document.getElementById("prevArrow")?.addEventListener("click", () => {
            prevSlide();
            stopAutoSlide();
            startAutoSlide();
        });

        document.getElementById("nextArrow")?.addEventListener("click", () => {
            nextSlide();
            stopAutoSlide();
            startAutoSlide();
        });

        // Hover pause
        const section = document.querySelector("section");
        section?.addEventListener("mouseenter", stopAutoSlide);
        section?.addEventListener("mouseleave", startAutoSlide);

        // Init
        showSlide(currentSlide);
        startAutoSlide();
    }

    if (typeof window !== "undefined") {
        if (document.readyState === "loading") {
            document.addEventListener("DOMContentLoaded", initSlider);
        } else {
            initSlider();
        }
    }
</script>

<style>
    .slide-text {
        will-change: opacity, transform;
        /* Añade un pequeño movimiento al aparecer */
        transform: translateY(1rem);
    }
    .slide-text.opacity-100 {
        transform: translateY(0);
    }

    .indicator {
        will-change: width, background-color;
        outline: none;
    }

    [id^="illustration-"] {
        will-change: transform, opacity;
        transition:
            transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1),
            opacity 0.5s ease-in-out;
    }
</style>
